# Get paginated credit transactions for an organization
# Includes related ai_capability and quality_level names
# Includes audit context: user and form snapshots
# Note: Uses where clause variable for flexible filtering
query GetCreditTransactions(
  $limit: Int!
  $offset: Int!
  $where: credit_transactions_bool_exp!
) {
  credit_transactions(
    where: $where
    order_by: { created_at: desc }
    limit: $limit
    offset: $offset
  ) {
    id
    transaction_type
    credits_amount
    balance_after
    description
    created_at
    # Related entities
    ai_capability {
      name
    }
    quality_level {
      name
    }
    # Audit context (ADR-023 Decision 8)
    user_id
    user_email
    form_id
    form_name
  }
  # Get total count for pagination
  credit_transactions_aggregate(where: $where) {
    aggregate {
      count
    }
  }
}
